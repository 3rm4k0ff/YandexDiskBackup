# Скрипт бэкапа сайтов на Яндекс.Диск

Упаковывает файл сайта в zip архив, создает mysql дамп, добавляет его к архиву и загружает архив с файлами и дампом на Я.Диск.

> На Я.Диске файлы сохраняются в специальной папке `Приложения/_Имя_приложения_` - это имя, которое вы указали в названии приложения в Yandex Oauth. Папка приложения создается автоматически при первой загрузке файла.

Каждый бэкап содержит в имени метку времени по UTC.

######Не забудьте установить расширение php-zip!
```bash 
sudo apt install php-zip
```

## Получение токена для доступа к API Яндекс.Диска

Зарегистрируйте приложение и получите токен в [oauth.yandex.ru/](https://oauth.yandex.ru/).

Для работы скрипта достаточно следующих привилегий:

- Доступ к информации о Диске
- Доступ к папке приложения на Диске

## Установка и настройка скрипта

__1.Склонируйте репозиторий__

```bash 
git clone https://github.com/3rm4k0ff/YandexDiskBackup.git
```

__2.Создайте пользователя в MySQL__

Создайте пользователя с правами только на чтение баз данных, которые вы хотите бэкапить:

```mysql
CREATE USER 'backup_user'@'localhost' IDENTIFIED BY 'secret';
GRANT SELECT, SHOW VIEW, LOCK TABLES, RELOAD, REPLICATION CLIENT, EVENT, TRIGGER ON *.* TO 'backup_user'@'localhost';
```

__3.Настройте скрипт__

```bash
php backuper.phar config
```

__4.Наслаждайтесь жизнью__
